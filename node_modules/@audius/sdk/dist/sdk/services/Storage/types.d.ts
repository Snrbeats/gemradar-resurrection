import { z } from 'zod';
import type { CrossPlatformFile } from '../../types/File';
import type { LoggerService } from '../Logger';
import type { StorageNodeSelectorService } from '../StorageNodeSelector';
/**
 * A handle to control an active upload.
 * Provides methods to interact with the upload without exposing the underlying implementation.
 */
export interface UploadHandle {
    /**
     * Starts the upload
     */
    start: () => Promise<UploadResponse>;
    /**
     * Aborts the upload
     */
    abort: (shouldTerminate?: boolean) => void;
}
export type StorageServiceConfigInternal = {
    /**
     * Logger service, defaults to console
     */
    logger: LoggerService;
};
export type StorageServiceConfig = Partial<StorageServiceConfigInternal> & {
    /**
     * The StorageNodeSelector service used to get the relevant storage node for content
     */
    storageNodeSelector: StorageNodeSelectorService;
};
export declare const ProgressEventSchema: z.ZodObject<{
    /**
     * Number of bytes loaded so far
     */
    loaded: z.ZodNumber;
    /**
     * Total number of bytes to be loaded
     */
    total: z.ZodNumber;
    /**
     * Progress of the transcoding process (0-1)
     */
    transcode: z.ZodNumber;
}, "strip", z.ZodTypeAny, {
    total: number;
    loaded: number;
    transcode: number;
}, {
    total: number;
    loaded: number;
    transcode: number;
}>;
export declare const ProgressEventHandlerSchema: z.ZodFunction<z.ZodTuple<[z.ZodObject<{
    /**
     * Number of bytes loaded so far
     */
    loaded: z.ZodNumber;
    /**
     * Total number of bytes to be loaded
     */
    total: z.ZodNumber;
    /**
     * Progress of the transcoding process (0-1)
     */
    transcode: z.ZodNumber;
}, "strip", z.ZodTypeAny, {
    total: number;
    loaded: number;
    transcode: number;
}, {
    total: number;
    loaded: number;
    transcode: number;
}>], z.ZodUnknown>, z.ZodVoid>;
declare const UploadCreatedHandlerSchema: z.ZodFunction<z.ZodTuple<[z.ZodObject<{
    abort: z.ZodFunction<z.ZodTuple<[z.ZodOptional<z.ZodBoolean>], z.ZodUnknown>, z.ZodVoid>;
}, "strip", z.ZodTypeAny, {
    abort: (args_0: boolean | undefined, ...args_1: unknown[]) => void;
}, {
    abort: (args_0: boolean | undefined, ...args_1: unknown[]) => void;
}>], z.ZodUnknown>, z.ZodVoid>;
export type UploadCreatedHandler = z.input<typeof UploadCreatedHandlerSchema>;
export type ProgressHandler = z.input<typeof ProgressEventHandlerSchema>;
export type FileTemplate = 'audio' | 'img_square' | 'img_backdrop';
export type UploadFileParams = {
    file: CrossPlatformFile;
    onProgress?: ProgressHandler;
    metadata: FileMetadata;
};
export type StorageService = {
    uploadFile: (params: UploadFileParams) => UploadHandle;
    getUploadStatus: (uploadId: string) => Promise<UploadResponse>;
    generatePreview: ({ cid, secondOffset }: {
        cid: string;
        secondOffset: number;
    }) => Promise<string>;
};
export type ProcessingStatus = 'new' | 'error' | 'busy' | 'timeout' | 'audio_analysis' | 'busy_audio_analysis' | 'done';
export type UploadResponse = {
    id: string;
    status: ProcessingStatus;
    results: {
        [key: string]: string;
    };
    orig_file_cid: string;
    orig_filename: string;
    audio_analysis_error_count: number;
    audio_analysis_results?: {
        bpm?: number;
        key?: string;
    } | null;
    probe?: {
        format?: {
            duration?: string;
        };
    };
    transcode_progress?: number;
};
export type FileMetadata = {
    filename?: string;
    filetype?: string;
    template: 'audio' | 'img_square' | 'img_backdrop';
    userWallet?: string;
    previewStartSeconds?: number;
    placementHosts?: string;
};
export {};
